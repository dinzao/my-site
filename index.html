<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Простой фото-сайт</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        header {
            background: #4CAF50;
            color: white;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .auth-section {
            display: flex;
            gap: 10px;
        }
        button, input[type="submit"] {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover, input[type="submit"]:hover {
            background: #45a049;
        }
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        .photo-item {
            background: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .photo-item img {
            width: 100%;
            height: auto;
            border-radius: 3px;
        }
        .photo-author {
            margin-top: 10px;
            font-style: italic;
            color: #666;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 5px;
            width: 300px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
        }
        .form-group input {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }
        .error {
            color: red;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Фото-сайт</h1>
        <div class="auth-section">
            <span id="username-display"></span>
            <button id="login-btn">Войти</button>
            <button id="register-btn">Регистрация</button>
            <button id="upload-btn" style="display: none;">Загрузить фото</button>
            <button id="logout-btn" style="display: none;">Выйти</button>
        </div>
    </header>

    <div id="photo-container" class="photo-grid"></div>

    <!-- Модальное окно регистрации -->
    <div id="register-modal" class="modal">
        <div class="modal-content">
            <h2>Регистрация</h2>
            <form id="register-form">
                <div class="form-group">
                    <label for="reg-username">Имя пользователя:</label>
                    <input type="text" id="reg-username" required>
                </div>
                <input type="submit" value="Зарегистрироваться">
                <div id="register-error" class="error"></div>
            </form>
        </div>
    </div>

    <!-- Модальное окно входа -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <h2>Вход</h2>
            <form id="login-form">
                <div class="form-group">
                    <label for="login-username">Имя пользователя:</label>
                    <input type="text" id="login-username" required>
                </div>
                <input type="submit" value="Войти">
                <div id="login-error" class="error"></div>
            </form>
        </div>
    </div>

    <!-- Модальное окно загрузки фото -->
    <div id="upload-modal" class="modal">
        <div class="modal-content">
            <h2>Загрузить фото</h2>
            <form id="upload-form">
                <div class="form-group">
                    <label for="photo-upload">Выберите фото:</label>
                    <input type="file" id="photo-upload" accept="image/*" required>
                </div>
                <input type="submit" value="Загрузить">
                <div id="upload-error" class="error"></div>
            </form>
        </div>
    </div>

    <script>
        // Инициализация данных
        let users = JSON.parse(localStorage.getItem('photo-site-users')) || [];
        let photos = JSON.parse(localStorage.getItem('photo-site-photos')) || [];
        let currentUser = null;

        // DOM элементы
        const photoContainer = document.getElementById('photo-container');
        const usernameDisplay = document.getElementById('username-display');
        const loginBtn = document.getElementById('login-btn');
        const registerBtn = document.getElementById('register-btn');
        const uploadBtn = document.getElementById('upload-btn');
        const logoutBtn = document.getElementById('logout-btn');

        // Модальные окна
        const registerModal = document.getElementById('register-modal');
        const loginModal = document.getElementById('login-modal');
        const uploadModal = document.getElementById('upload-modal');

        // Формы
        const registerForm = document.getElementById('register-form');
        const loginForm = document.getElementById('login-form');
        const uploadForm = document.getElementById('upload-form');

        // Ошибки
        const registerError = document.getElementById('register-error');
        const loginError = document.getElementById('login-error');
        const uploadError = document.getElementById('upload-error');

        // Инициализация при загрузке
        document.addEventListener('DOMContentLoaded', () => {
            updateUI();
            renderPhotos();
        });

        // Обновление интерфейса в зависимости от авторизации
        function updateUI() {
            if (currentUser) {
                usernameDisplay.textContent = `Привет, ${currentUser}!`;
                loginBtn.style.display = 'none';
                registerBtn.style.display = 'none';
                uploadBtn.style.display = 'block';
                logoutBtn.style.display = 'block';
            } else {
                usernameDisplay.textContent = '';
                loginBtn.style.display = 'block';
                registerBtn.style.display = 'block';
                uploadBtn.style.display = 'none';
                logoutBtn.style.display = 'none';
            }
        }

        // Отображение фотографий
        function renderPhotos() {
            photoContainer.innerHTML = '';
            photos.forEach(photo => {
                const photoItem = document.createElement('div');
                photoItem.className = 'photo-item';
                photoItem.innerHTML = `
                    <img src="${photo.image}" alt="Фото пользователя ${photo.author}">
                    <div class="photo-author">Автор: ${photo.author}</div>
                `;
                photoContainer.appendChild(photoItem);
            });
        }

        // Открытие модальных окон
        registerBtn.addEventListener('click', () => {
            registerModal.style.display = 'flex';
            registerError.textContent = '';
        });

        loginBtn.addEventListener('click', () => {
            loginModal.style.display = 'flex';
            loginError.textContent = '';
        });

        uploadBtn.addEventListener('click', () => {
            uploadModal.style.display = 'flex';
            uploadError.textContent = '';
        });

        // Закрытие модальных окон при клике вне их
        window.addEventListener('click', (e) => {
            if (e.target === registerModal) registerModal.style.display = 'none';
            if (e.target === loginModal) loginModal.style.display = 'none';
            if (e.target === uploadModal) uploadModal.style.display = 'none';
        });

        // Регистрация
        registerForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = document.getElementById('reg-username').value.trim();
            
            if (!username) {
                registerError.textContent = 'Введите имя пользователя';
                return;
            }
            
            if (users.includes(username)) {
                registerError.textContent = 'Это имя уже занято';
                return;
            }
            
            users.push(username);
            localStorage.setItem('photo-site-users', JSON.stringify(users));
            currentUser = username;
            updateUI();
            registerModal.style.display = 'none';
            registerForm.reset();
        });

        // Вход
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = document.getElementById('login-username').value.trim();
            
            if (!username) {
                loginError.textContent = 'Введите имя пользователя';
                return;
            }
            
            if (!users.includes(username)) {
                loginError.textContent = 'Пользователь не найден';
                return;
            }
            
            currentUser = username;
            updateUI();
            loginModal.style.display = 'none';
            loginForm.reset();
        });

        // Выход
        logoutBtn.addEventListener('click', () => {
            currentUser = null;
            updateUI();
        });

        // Загрузка фото
        uploadForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const fileInput = document.getElementById('photo-upload');
            const file = fileInput.files[0];
            
            if (!file) {
                uploadError.textContent = 'Выберите файл';
                return;
            }
            
            if (!file.type.match('image.*')) {
                uploadError.textContent = 'Выберите изображение';
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const newPhoto = {
                    author: currentUser,
                    image: e.target.result
                };
                
                photos.push(newPhoto);
                localStorage.setItem('photo-site-photos', JSON.stringify(photos));
                renderPhotos();
                uploadModal.style.display = 'none';
                uploadForm.reset();
            };
            reader.readAsDataURL(file);
        });
    </script>
</body>
</html>
